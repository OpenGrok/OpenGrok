# This references an OpenJDK container from the
# Docker Hub https://hub.docker.com/_/openjdk/
# Read more about containers on our dev center
# http://devcenter.wercker.com/docs/containers/index.html
box: openjdk:8-jdk

# This should switch to Oracle JDK however does not work:
##box:
##  id: store/oracle/serverjre
##  username: $DOCKER_USERNAME
##  password: $DOCKER_PASSWORD
##  tag: 8

# This is the build pipeline. Pipelines are the core of wercker
# Read more about pipelines on our dev center
# http://devcenter.wercker.com/docs/pipelines/index.html
build:
    # Steps make up the actions in your pipeline
    # Read more about steps on our dev center:
    # http://devcenter.wercker.com/docs/steps/index.html
  steps:
    - install-packages:
      packages: git subversion mercurial sudo maven
    - script:
      name: Maven install
      code: |
        /usr/sbin/groupadd -g 1000 foobar
        /usr/sbin/useradd -u 1000 -g 1000 -s /bin/bash -m foobar
        echo $WERCKER_ROOT
	chown -R foobar $WERCKER_ROOT
        /usr/bin/sudo -i -u foobar -- bash -c 'cd /pipeline/source; /usr/bin/mvn -X install'

#    # https://github.com/wercker/step-maven
#    - wercker/maven:
#      goals: install
#      cache_repo: true
#      version: 3.5.2
